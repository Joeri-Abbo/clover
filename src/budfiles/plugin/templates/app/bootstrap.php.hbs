<?php

/**
 * The bootstrap file creates and returns the plugin container.
 */

namespace {{pascalcase namespace}};

require __DIR__ . '/../vendor/autoload.php';

use function DI\autowire;
use function DI\create;
use DI\ContainerBuilder;

/**
 * Build the container instance
 */
return (new ContainerBuilder)->addDefinitions([
    /**
     * Plugin bindings
     */
    Plugin\Registration::class => autowire(Plugin\Registration::class),
    Plugin\Activate::class => Plugin\Activate::class,
    Plugin\Deactivate::class => Plugin\Deactivate::class,
    Block\Contract\BlockInterface::class => autowire(Block\Block::class),
    Manifest\Contract\ManifestInterface::class => autowire(Manifest\Manifest::class),

    /**
     * Plugin aliases
     */
    'plugin.activate' => create(Plugin\Activate::class),
    'plugin.deactivate' => create(Plugin\Deactivate::class),
    'plugin.registration' => autowire(Plugin\Registration::class),
    'block' => autowire(Block\Block::class),
    'manifest' => autowire(Manifest\Manifest::class),

    /**
     * Vendor bindings
     */
    Illuminate\Support\Collection::class => autowire(Illuminate\Support\Collection::class),

    /**
     * Vendor aliases
     */
    'collection' => autowire('Illuminate\Support\Collection'),

    /**
     * Config
     */
    'plugin.namespace' => '{{lowercase (dashcase namespace)}}',
    'plugin.url' => plugins_url('', __DIR__),
    'path.wp' => WP_CONTENT_DIR,
    'path.wp.plugins' => plugin_dir_path('', __DIR__),
    'path.wp.uploads' => (object) wp_upload_dir(),
    'path.plugin' => realpath(__DIR__ . '/../'),
    'path.plugin.dist' => realpath(__DIR__ . '/../dist/'),
    'path.plugin.src' => realpath(__DIR__ . '/../src/'),
    'path.plugin.src.blocks' => realpath(__DIR__ . '/../src/blocks'),
    'path.plugin.src.plugins' => realpath(__DIR__ . '/../src/plugins'),
    'path.plugin.storage' => realpath(__DIR__ . '/../storage/'),
    'path.plugin.storage.cache' => realpath(__DIR__ . '/../storage/cache'),
    'path.plugin.activate' => realpath(__DIR__ . '/Plugin/Activate.php'),
    'path.plugin.deactivate' => realpath(__DIR__ . '/Plugin/Deactivate.php'),
])->build();
